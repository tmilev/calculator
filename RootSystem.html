<html>
<head> 
<title>
Root systems
</title>
</head>
<body>
<form method="POST" name="formCalculator" action="/cgi-bin/calculator">
<textarea name="textInput" style="width:100px; height:50px" id="textInputID" onkeypress="if (event.keyCode == 13) {this.form.submit(); return false;}">
Some text
</textarea>
<input type="submit" name="buttonGo" value="Go" onmousedown="storeSettings()">
</form>


<!>
<script type="text/javascript"> 
var timeOutCounter=0;
window.setTimeout("progressReport()",1000);
var newReportString="";
function progressReport()
{ timeOutCounter++;
  var oRequest = new XMLHttpRequest();
  var sURL  = "/tmp/report.txt";
  oRequest.open("GET",sURL,false);
  oRequest.setRequestHeader("User-Agent",navigator.userAgent);
  oRequest.send(null)
  if (oRequest.status==200)
    newReportString= oRequest.responseText;
  el = document.getElementById("idProgressReport").innerHTML= "Number of clock ticks since last open: "+ timeOutCounter+"<br>Status file content:<br>" +newReportString;
  window.setTimeout("progressReport()",1000);
}
</script>
<div id="idProgressReport">
</div>


<!>
<script src="http://ajax.googleapis.com/ajax/libs/dojo/1.6.1/dojo/dojo.xd.js" type="text/javascript"></script>

 <select name="textType" id="textType" onchange="makeCartanArbitrary(document.getElementById('textType'), document.getElementById(textDim)); storeSettings(); this.form.submit();">
  <option>A</option>
  <option selected="1">B</option>
  <option>C</option>
  <option>D</option>
  <option>E</option>
  <option>F</option>
  <option>G</option>
</select>
<select name="textDim" id="textDim" onchange="makeCartanArbitrary(document.getElementById('textType'), document.getElementById(textDim)); storeSettings(); this.form.submit();">
  <option>1</option>
  <option>2</option>
  <option selected="1">3</option>
  <option>4</option>
  <option>5</option>
  <option>6</option>
  <option>7</option>
  <option>8</option>
</select> Root system.
<script type="text/javascript"> 
function switchMenu(obj){ var el = document.getElementById(obj);	if ( el.style.display != "none" ) { el.style.display = 'none'; } else { el.style.display = '';}}
</script>
<script type="text/javascript"> 
function getCookie(c_name)
{ VPFcookie=document.cookie.split(";");
  for (i=0;i<VPFcookie.length;i++)
  { x=VPFcookie[i].substr(0,VPFcookie[i].indexOf("="));
  	y=VPFcookie[i].substr(VPFcookie[i].indexOf("=")+1);
    x=x.replace(/^\s+|\s+$/g,"");
    if (x==c_name)
      return unescape(y);
  }
}
function storeSettings()
{ theCalculatorForm=document.getElementById("textInputID");  
  //alert(theCalculatorForm.style.width);
  addCookie("widthCalculatorText", theCalculatorForm.style.width, 100);  
  addCookie("heightCalculatorText", theCalculatorForm.style.height, 100);
  //alert(document.cookie);
}

function addCookie(theName, theValue, exdays)
{ exdate=new Date();
  exdate.setDate(exdate.getDate() + exdays);
  c_value=escape(theValue) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
  document.cookie=theName + "=" + c_value;
}

window.setTimeout("checkCookie()",1000);

function checkCookie()
{ theCalculatorForm=document.getElementById("textInputID");  
  theOldWidth=getCookie("widthCalculatorText");
  theOldHeight=getCookie("heightCalculatorText");
  //alert("height: " + theOldHeight +" width: " + theOldWidth);
  //theCalculatorForm.setStyle("width:"+ theOldWidth);
//  theCalculatorForm.style.height=theOldHeight;
  theCalculatorForm.style.width=theOldWidth;
  theCalculatorForm.style.height=theOldHeight;
}
</script>
<!>
  <script language="javascript">
    //The script is courtesy of Madan Chaudhary. The original code was hosted at http://simpleandeasycodes.blogspot.com/ .
    //The code is slightly modified from the original, and will continue to be modified.
    //Many thanks to Madan Chaudhary for allowing the use of his code!
    //****************************************************************************
    function actb(obj,ca){
    /* ---- Public Variables ---- */
    this.saec_timeOut = -1; // Autocomplete Timeout in ms (-1: autocomplete never time out)
    this.saec_lim = 4;    // Number of elements autocomplete can show (-1: no limit)
    this.saec_firstText = false; // should the auto complete be limited to the beginning of keyword?
    this.saec_mouse = true; // Enable Mouse Support
    this.saec_delimiter = new Array(';',' ');  // Delimiter for multiple autocomplete. Set it to empty array for single autocomplete
    this.saec_startcheck = 1; // Show widget only after this number of characters is typed in.
    /* ---- Public Variables ---- */
    
    //Customize style according to your requirement
    /* --- Styles --- */
    this.saec_bgColor = '#999999';
    this.saec_textColor = '#ffffff';
    this.saec_hColor = '#000000';
    this.saec_fFamily = 'verdana';
    this.saec_fSize = '15px';
    this.saec_hStyle = 'text-decoration:underline;font-weight:bold';
    /* --- Styles --- */

    /* ---- Private Variables ---- */
    var saec_delimwords = new Array();
    var saec_cdelimword = 0;
    var saec_delimchar = new Array();
    var saec_display = false;
    var saec_pos = 0;
    var saec_total = 0;
    var saec_curr = null;
    var saec_rangeu = 0;
    var saec_ranged = 0;
    var saec_bool = new Array();
    var saec_pre = 0;
    var saec_toid;
    var saec_tomake = false;
    var saec_getpre = "";
    var saec_mouse_on_list = 1;
    var saec_kwcount = 0;
    var saec_caretmove = false;
    this.saec_keywords = new Array();
    /* ---- Private Variables---- */
    
    this.saec_keywords = ca;
    var saec_self = this;

    saec_curr = obj;
    
    addEvent(saec_curr,"focus",saec_setup);
    function saec_setup(){
        addEvent(document,"keydown",saec_checkkey);
        addEvent(saec_curr,"blur",saec_clear);
        addEvent(document,"keypress",saec_keypress);
    }

    function saec_clear(evt){
        if (!evt) evt = event;
        removeEvent(document,"keydown",saec_checkkey);
        removeEvent(saec_curr,"blur",saec_clear);
        removeEvent(document,"keypress",saec_keypress);
        saec_removedisp();
    }
    function saec_parse(n){
        if (saec_self.saec_delimiter.length > 0){
            var t = saec_delimwords[saec_cdelimword].trim().addslashes();
            var plen = saec_delimwords[saec_cdelimword].trim().length;
        }else{
            var t = saec_curr.value.addslashes();
            var plen = saec_curr.value.length;
        }
        var tobuild = '';
        var i;

        if (saec_self.saec_firstText){
            var re = new RegExp("^" + t, "i");
        }else{
            var re = new RegExp(t, "i");
        }
        var p = n.search(re);
                
        for (i=0;i<p;i++){
            tobuild += n.substr(i,1);
        }
        tobuild += "<font style='"+(saec_self.saec_hStyle)+"'>"
        for (i=p;i<plen+p;i++){
            tobuild += n.substr(i,1);
        }
        tobuild += "</font>";
            for (i=plen+p;i<n.length;i++){
            tobuild += n.substr(i,1);
        }
        return tobuild;
    }
    function saec_VPFspecific_generate(){ 
	if (saec_kwcount>10)
		return;
	for (i=0; i<saec_self.saec_keywords.length; i++)
	{	currentName="functionBox"+saec_keywords[i];
		currentBox=document.getElementById(currentName);
		if (saec_bool[i] )			
			currentBox.style.display="inline";	
		else
			currentBox.style.display="none";	
	}

    }
    function saec_generate(){
        if (document.getElementById('tat_table')){ saec_display = false;document.body.removeChild(document.getElementById('tat_table')); } 
	saec_VPFspecific_generate();        
	if (saec_kwcount == 0){
            saec_display = false;
            return;
        }
        a = document.createElement('table');
        a.cellSpacing='1px';
        a.cellPadding='2px';
        a.style.position='absolute';
        a.style.top = eval(curTop(saec_curr) + saec_curr.offsetHeight) + "px";
        a.style.left = curLeft(saec_curr) + "px";
        a.style.backgroundColor=saec_self.saec_bgColor;
        a.id = 'tat_table';
        document.body.appendChild(a);
        var i;
        var first = true;
        var j = 1;
        if (saec_self.saec_mouse){
            a.onmouseout = saec_table_unfocus;
            a.onmouseover = saec_table_focus;
        }
        var counter = 0;
        for (i=0;i<saec_self.saec_keywords.length;i++){
            if (saec_bool[i]){
                counter++;
                r = a.insertRow(-1);
                if (first && !saec_tomake){
                    r.style.backgroundColor = saec_self.saec_hColor;
                    first = false;
                    saec_pos = counter;
                }else if(saec_pre == i){
                    r.style.backgroundColor = saec_self.saec_hColor;
                    first = false;
                    saec_pos = counter;
                }else{
                    r.style.backgroundColor = saec_self.saec_bgColor;
                }
                r.id = 'tat_tr'+(j);
                c = r.insertCell(-1);
                c.style.color = saec_self.saec_textColor;
                c.style.fontFamily = saec_self.saec_fFamily;
                c.style.fontSize = saec_self.saec_fSize;
                c.innerHTML = saec_parse(saec_self.saec_keywords[i]);
                c.id = 'tat_td'+(j);
                c.setAttribute('pos',j);
                if (saec_self.saec_mouse){
                    c.style.cursor = 'pointer';
                    c.onclick=saec_mouseclick;
                    c.onmouseover = saec_table_highlight;
                }
                j++;
            }
            if (j - 1 == saec_self.saec_lim && j < saec_total){
                r = a.insertRow(-1);
                r.style.backgroundColor = saec_self.saec_bgColor;
                c = r.insertCell(-1);
                c.style.color = saec_self.saec_textColor;
                c.style.fontFamily = 'arial narrow';
                c.style.fontSize = saec_self.saec_fSize;
                c.align='center';
                replaceHTML(c,'\\/');
                if (saec_self.saec_mouse){
                    c.style.cursor = 'pointer';
                    c.onclick = saec_mouse_down;
                }
                break;
            }
        }
        saec_rangeu = 1;
        saec_ranged = j-1;
        saec_display = true;
        if (saec_pos <= 0) saec_pos = 1;
    }
    function saec_remake(){
        document.body.removeChild(document.getElementById('tat_table'));
        a = document.createElement('table');
        a.cellSpacing='1px';
        a.cellPadding='2px';
        a.style.position='absolute';
        a.style.top = eval(curTop(saec_curr) + saec_curr.offsetHeight) + "px";
        a.style.left = curLeft(saec_curr) + "px";
        a.style.backgroundColor=saec_self.saec_bgColor;
        a.id = 'tat_table';
        if (saec_self.saec_mouse){
            a.onmouseout= saec_table_unfocus;
            a.onmouseover=saec_table_focus;
        }
        document.body.appendChild(a);
        var i;
        var first = true;
        var j = 1;
        if (saec_rangeu > 1){
            r = a.insertRow(-1);
            r.style.backgroundColor = saec_self.saec_bgColor;
            c = r.insertCell(-1);
            c.style.color = saec_self.saec_textColor;
            c.style.fontFamily = 'arial narrow';
            c.style.fontSize = saec_self.saec_fSize;
            c.align='center';
            replaceHTML(c,'/\\');
            if (saec_self.saec_mouse){
                c.style.cursor = 'pointer';
                c.onclick = saec_mouse_up;
            }
        }
        for (i=0;i<saec_self.saec_keywords.length;i++){
            if (saec_bool[i]){
                if (j >= saec_rangeu && j <= saec_ranged){
                    r = a.insertRow(-1);
                    r.style.backgroundColor = saec_self.saec_bgColor;
                    r.id = 'tat_tr'+(j);
                    c = r.insertCell(-1);
                    c.style.color = saec_self.saec_textColor;
                    c.style.fontFamily = saec_self.saec_fFamily;
                    c.style.fontSize = saec_self.saec_fSize;
                    c.innerHTML = saec_parse(saec_self.saec_keywords[i]);
                    c.id = 'tat_td'+(j);
                    c.setAttribute('pos',j);
                    if (saec_self.saec_mouse){
                        c.style.cursor = 'pointer';
                        c.onclick=saec_mouseclick;
                        c.onmouseover = saec_table_highlight;
                    }
                    j++;
                }else{
                    j++;
                }
            }
            if (j > saec_ranged) break;
        }
        if (j-1 < saec_total){
            r = a.insertRow(-1);
            r.style.backgroundColor = saec_self.saec_bgColor;
            c = r.insertCell(-1);
            c.style.color = saec_self.saec_textColor;
            c.style.fontFamily = 'arial narrow';
            c.style.fontSize = saec_self.saec_fSize;
            c.align='center';
            replaceHTML(c,'\\/');
            if (saec_self.saec_mouse){
                c.style.cursor = 'pointer';
                c.onclick = saec_mouse_down;
            }
        }
    }
    function saec_goup(){
        if (!saec_display) return;
        if (saec_pos == 1) return;
        document.getElementById('tat_tr'+saec_pos).style.backgroundColor = saec_self.saec_bgColor;
        saec_pos--;
        if (saec_pos < saec_rangeu) saec_moveup();
        document.getElementById('tat_tr'+saec_pos).style.backgroundColor = saec_self.saec_hColor;
        if (saec_toid) clearTimeout(saec_toid);
        if (saec_self.saec_timeOut > 0) saec_toid = setTimeout(function(){saec_mouse_on_list=0;saec_removedisp();},saec_self.saec_timeOut);
    }
    function saec_godown(){
        if (!saec_display) return;
        if (saec_pos == saec_total) return;
        document.getElementById('tat_tr'+saec_pos).style.backgroundColor = saec_self.saec_bgColor;
        saec_pos++;
        if (saec_pos > saec_ranged) saec_movedown();
        document.getElementById('tat_tr'+saec_pos).style.backgroundColor = saec_self.saec_hColor;
        if (saec_toid) clearTimeout(saec_toid);
        if (saec_self.saec_timeOut > 0) saec_toid = setTimeout(function(){saec_mouse_on_list=0;saec_removedisp();},saec_self.saec_timeOut);
    }
    function saec_movedown(){
        saec_rangeu++;
        saec_ranged++;
        saec_remake();
    }
    function saec_moveup(){
        saec_rangeu--;
        saec_ranged--;
        saec_remake();
    }

    /* Mouse */
    function saec_mouse_down(){
        document.getElementById('tat_tr'+saec_pos).style.backgroundColor = saec_self.saec_bgColor;
        saec_pos++;
        saec_movedown();
        document.getElementById('tat_tr'+saec_pos).style.backgroundColor = saec_self.saec_hColor;
        saec_curr.focus();
        saec_mouse_on_list = 0;
        if (saec_toid) clearTimeout(saec_toid);
        if (saec_self.saec_timeOut > 0) saec_toid = setTimeout(function(){saec_mouse_on_list=0;saec_removedisp();},saec_self.saec_timeOut);
    }
    function saec_mouse_up(evt){
        if (!evt) evt = event;
        if (evt.stopPropagation){
            evt.stopPropagation();
        }else{
            evt.cancelBubble = true;
        }
        document.getElementById('tat_tr'+saec_pos).style.backgroundColor = saec_self.saec_bgColor;
        saec_pos--;
        saec_moveup();
        document.getElementById('tat_tr'+saec_pos).style.backgroundColor = saec_self.saec_hColor;
        saec_curr.focus();
        saec_mouse_on_list = 0;
        if (saec_toid) clearTimeout(saec_toid);
        if (saec_self.saec_timeOut > 0) saec_toid = setTimeout(function(){saec_mouse_on_list=0;saec_removedisp();},saec_self.saec_timeOut);
    }
    function saec_mouseclick(evt){
        if (!evt) evt = event;
        if (!saec_display) return;
        saec_mouse_on_list = 0;
        saec_pos = this.getAttribute('pos');
        saec_penter();
    }
    function saec_table_focus(){
        saec_mouse_on_list = 1;
    }
    function saec_table_unfocus(){
        saec_mouse_on_list = 0;
        if (saec_toid) clearTimeout(saec_toid);
        if (saec_self.saec_timeOut > 0) saec_toid = setTimeout(function(){saec_mouse_on_list = 0;saec_removedisp();},saec_self.saec_timeOut);
    }
    function saec_table_highlight(){
        saec_mouse_on_list = 1;
        document.getElementById('tat_tr'+saec_pos).style.backgroundColor = saec_self.saec_bgColor;
        saec_pos = this.getAttribute('pos');
        while (saec_pos < saec_rangeu) saec_moveup();
        while (saec_pos > saec_ranged) saec_movedown();
        document.getElementById('tat_tr'+saec_pos).style.backgroundColor = saec_self.saec_hColor;
        if (saec_toid) clearTimeout(saec_toid);
        if (saec_self.saec_timeOut > 0) saec_toid = setTimeout(function(){saec_mouse_on_list = 0;saec_removedisp();},saec_self.saec_timeOut);
    }
    /* ---- */

    function saec_insertword(a){
        if (saec_self.saec_delimiter.length > 0){
            str = '';
            l=0;
            for (i=0;i<saec_delimwords.length;i++){
                if (saec_cdelimword == i){
                    prespace = postspace = '';
                    gotbreak = false;
                    for (j=0;j<saec_delimwords[i].length;++j){
                        if (saec_delimwords[i].charAt(j) != ' '){
                            gotbreak = true;
                            break;
                        }
                        prespace += ' ';
                    }
                    for (j=saec_delimwords[i].length-1;j>=0;--j){
                        if (saec_delimwords[i].charAt(j) != ' ') break;
                        postspace += ' ';
                    }
                    str += prespace;
                    str += a;
                    l = str.length;
                    if (gotbreak) str += postspace;
                }else{
                    str += saec_delimwords[i];
                }
                if (i != saec_delimwords.length - 1){
                    str += saec_delimchar[i];
                }
            }
            saec_curr.value = str;
            setCaret(saec_curr,l);
        }else{
            saec_curr.value = a;
        }
        saec_mouse_on_list = 0;
        saec_removedisp();
    }
    function saec_penter(){
        if (!saec_display) return;
        saec_display = false;
        var word = '';
        var c = 0;
        for (var i=0;i<=saec_self.saec_keywords.length;i++){
            if (saec_bool[i]) c++;
            if (c == saec_pos){
                word = saec_self.saec_keywords[i];
                break;
            }
        }
        saec_insertword(word);
        l = getCaretStart(saec_curr);
    }
function saec_VPF_isDelim(input)
{ delimChars=" ()+-/,*_";
  for (i=0; i<delimChars.length; i++)
    if (input==delimChars[i])
      return true;
  return false;
}
    function saec_VPFspecific_removeDisp(){ 
	if (saec_curr.value.length>0)
	{	if (!saec_VPF_isDelim(saec_curr.value[saec_curr.value.length-1]))
			return;
	}
	for (i=0; i<saec_self.saec_keywords.length; i++)
	{	currentName="functionBox"+saec_keywords[i];
		currentBox=document.getElementById(currentName);
		currentBox.style.display="inline";	
	}
    }
    function saec_removedisp(){
	saec_VPFspecific_removeDisp();
        if (saec_mouse_on_list==0){
            saec_display = 0;
            if (document.getElementById('tat_table')){ document.body.removeChild(document.getElementById('tat_table')); }
            if (saec_toid) clearTimeout(saec_toid);
        }
    }
    function saec_keypress(e){
        if (saec_caretmove) stopEvent(e);
        return !saec_caretmove;
    }
    function saec_checkkey(evt){
        if (!evt) evt = event;
        a = evt.keyCode;
        caret_pos_start = getCaretStart(saec_curr);
        saec_caretmove = 0;
        switch (a){
            case 38:
                saec_goup();
                saec_caretmove = 1;
                return false;
                break;
            case 40:
                saec_godown();
                saec_caretmove = 1;
                return false;
                break;
            case 13: case 9:
                if (saec_display){
                    saec_caretmove = 1;
                    saec_penter();
                    return false;
                }else{
                    return true;
                }
                break;
            default:
                setTimeout(function(){saec_tocomplete(a)},50);
                break;
        }
    }

    function saec_tocomplete(kc){
        if (kc == 38 || kc == 40 || kc == 13) return;
        var i;
	
        if (saec_display){ 
            var word = 0;
            var c = 0;
            for (var i=0;i<=saec_self.saec_keywords.length;i++){
                if (saec_bool[i]) c++;
                if (c == saec_pos){
                    word = i;
                    break;
                }
            }
            saec_pre = word;
        }else{ saec_pre = -1};
        
        if (saec_curr.value == ''){
            saec_mouse_on_list = 0;
            saec_removedisp();
            return;
        }
        if (saec_self.saec_delimiter.length > 0){
            caret_pos_start = getCaretStart(saec_curr);
            caret_pos_end = getCaretEnd(saec_curr);
            
            delim_split = '';
            for (i=0;i<saec_self.saec_delimiter.length;i++){
                delim_split += saec_self.saec_delimiter[i];
            }
            delim_split = delim_split.addslashes();
            delim_split_rx = new RegExp("(["+delim_split+"])");
            c = 0;
            saec_delimwords = new Array();
            saec_delimwords[0] = '';
            for (i=0,j=saec_curr.value.length;i<saec_curr.value.length;i++,j--){
                if (saec_curr.value.substr(i,j).search(delim_split_rx) == 0){
                    ma = saec_curr.value.substr(i,j).match(delim_split_rx);
                    saec_delimchar[c] = ma[1];
                    c++;
                    saec_delimwords[c] = '';
                }else{
                    saec_delimwords[c] += saec_curr.value.charAt(i);
                }
            }

            var l = 0;
            saec_cdelimword = -1;
            for (i=0;i<saec_delimwords.length;i++){
                if (caret_pos_end >= l && caret_pos_end <= l + saec_delimwords[i].length){
                    saec_cdelimword = i;
                }
                l+=saec_delimwords[i].length + 1;
            }
            var ot = saec_delimwords[saec_cdelimword].trim(); 
            var t = saec_delimwords[saec_cdelimword].addslashes().trim();
        }else{
            var ot = saec_curr.value;
            var t = saec_curr.value.addslashes();
        }
        if (ot.length == 0){
            saec_mouse_on_list = 0;
            saec_removedisp();
        }
        if (ot.length < saec_self.saec_startcheck) return this;
        if (saec_self.saec_firstText){
            var re = new RegExp("^" + t, "i");
        }else{
            var re = new RegExp(t, "i");
        }

        saec_total = 0;
        saec_tomake = false;
        saec_kwcount = 0;
        for (i=0;i<saec_self.saec_keywords.length;i++){
            saec_bool[i] = false;
            if (re.test(saec_self.saec_keywords[i])){
                saec_total++;
                saec_bool[i] = true;
                saec_kwcount++;
                if (saec_pre == i) saec_tomake = true;
            }
        }

        if (saec_toid) clearTimeout(saec_toid);
        if (saec_self.saec_timeOut > 0) saec_toid = setTimeout(function(){saec_mouse_on_list = 0;saec_removedisp();},saec_self.saec_timeOut);
        saec_generate();
    }
    return this;
}


    /* Event Functions */

    // Add an event to the obj given
    // event_name refers to the event trigger, without the "on", like click or mouseover
    // func_name refers to the function callback when event is triggered
    function addEvent(obj,event_name,func_name){
        if (obj.attachEvent){
            obj.attachEvent("on"+event_name, func_name);
        }else if(obj.addEventListener){
            obj.addEventListener(event_name,func_name,true);
        }else{
            obj["on"+event_name] = func_name;
        }
    }

    // Removes an event from the object
    function removeEvent(obj,event_name,func_name){
        if (obj.detachEvent){
            obj.detachEvent("on"+event_name,func_name);
        }else if(obj.removeEventListener){
            obj.removeEventListener(event_name,func_name,true);
        }else{
            obj["on"+event_name] = null;
        }
    }

    // Stop an event from bubbling up the event DOM
    function stopEvent(evt){
        evt || window.event;
        if (evt.stopPropagation){
            evt.stopPropagation();
            evt.preventDefault();
        }else if(typeof evt.cancelBubble != "undefined"){
            evt.cancelBubble = true;
            evt.returnValue = false;
        }
        return false;
    }

    // Get the obj that starts the event
    function getElement(evt){
        if (window.event){
            return window.event.srcElement;
        }else{
            return evt.currentTarget;
        }
    }
    // Get the obj that triggers off the event
    function getTargetElement(evt){
        if (window.event){
            return window.event.srcElement;
        }else{
            return evt.target;
        }
    }
    // For IE only, stops the obj from being selected
    function stopSelect(obj){
        if (typeof obj.onselectstart != 'undefined'){
            addEvent(obj,"selectstart",function(){ return false;});
        }
    }

    /*    Caret Functions     */

    // Get the end position of the caret in the object. Note that the obj needs to be in focus first
    function getCaretEnd(obj){
        if(typeof obj.selectionEnd != "undefined"){
            return obj.selectionEnd;
        }else if(document.selection&&document.selection.createRange){
            var M=document.selection.createRange();
            try{
                var Lp = M.duplicate();
                Lp.moveToElementText(obj);
            }catch(e){
                var Lp=obj.createTextRange();
            }
            Lp.setEndPoint("EndToEnd",M);
            var rb=Lp.text.length;
            if(rb>obj.value.length){
                return -1;
            }
            return rb;
        }
    }
    // Get the start position of the caret in the object
    function getCaretStart(obj){
        if(typeof obj.selectionStart != "undefined"){
            return obj.selectionStart;
        }else if(document.selection&&document.selection.createRange){
            var M=document.selection.createRange();
            try{
                var Lp = M.duplicate();
                Lp.moveToElementText(obj);
            }catch(e){
                var Lp=obj.createTextRange();
            }
            Lp.setEndPoint("EndToStart",M);
            var rb=Lp.text.length;
            if(rb>obj.value.length){
                return -1;
            }
            return rb;
        }
    }
    // sets the caret position to l in the object
    function setCaret(obj,l){
        obj.focus();
        if (obj.setSelectionRange){
            obj.setSelectionRange(l,l);
        }else if(obj.createTextRange){
            m = obj.createTextRange();        
            m.moveStart('character',l);
            m.collapse();
            m.select();
        }
    }
    // sets the caret selection from s to e in the object
    function setSelection(obj,s,e){
        obj.focus();
        if (obj.setSelectionRange){
            obj.setSelectionRange(s,e);
        }else if(obj.createTextRange){
            m = obj.createTextRange();        
            m.moveStart('character',s);
            m.moveEnd('character',e);
            m.select();
        }
    }

    /*    Escape function   */
    String.prototype.addslashes = function(){
        return this.replace(/(["\\\.\|\[\]\^\*\+\?\$\(\)])/g, '\\$1');
    }
    String.prototype.trim = function () {
        return this.replace(/^\s*(\S*(\s+\S+)*)\s*$/, "$1");
    };
    /* --- Escape --- */

    /* Offset position from top of the screen */
    function curTop(obj){
        toreturn = 0;
        while(obj){
            toreturn += obj.offsetTop;
            obj = obj.offsetParent;
        }
        return toreturn;
    }
    function curLeft(obj){
        toreturn = 0;
        while(obj){
            toreturn += obj.offsetLeft;
            obj = obj.offsetParent;
        }
        return toreturn;
    }
    /* ------ End of Offset function ------- */

    /* Types Function */

    // is a given input a number?
    function isNumber(a) {
        return typeof a == 'number' && isFinite(a);
    }

    /* Object Functions */

    function replaceHTML(obj,text){
        while(el = obj.childNodes[0]){
            obj.removeChild(el);
        };
        obj.appendChild(document.createTextNode(text));
    }

    //****************************************************************************
  </script>

<!>
<div style="width:400;height:400;border:solid 1px" id="idCanvasMain" onmousemove="mouseMoveRedraw(event.clientX, event.clientY);" onmousedown="
clickCanvasMain(event.clientX, event.clientY);
//changeBasis(1, 50, 50); drawOnCanvasMain();" DOMMouseScroll="mouseHandleWheel(event);" onmousewheel="mouseHandleWheel(event);" onmouseup="ButtonIsDown=false; selectedBasisIndex=-1;"></div>
<br>
The basis vectors correspond to the vertices of the Dynkin diagram.<br>
You can drag the center and the basis vectors.<button onclick="switchMenu('rotationExplanation')">More info</button>
<br>
<div id="rotationExplanation" style="display: none">
The i^th vector corresponds to the i^th node of the Dynkin diagram of the root system.<br>
The nodes are labeled in Bourbaki order.<br>
Let the two dimensional plane we project onto be spanned by vectors e_1 and e_2.<br>
Let v be a basis vector which you drag, with orthogonal projection in the (e_1,e_2) plane equal to v' <br>
and with orthogonal complement v'':=v-v'.<br>
When you drag a basis vector v, you do two things.<br>
1) You rotate e_1 and e_2 in the (e_1,e_2) plane, to match the rotation angle given by your mouse pointer<br>
2) Then you apply a rotation in the (v,v'')-plane that preserves the orthogonal complement of the (v,v'')-plane <br> 
such as to match the length of v' determined by your mouse pointer. <br>
Note that this operation is not defined if v lies in the (e_1, e_2) plane. <br>
If the above is the case, you will not be able to modify the length of v'. <br>  
<textarea id="debugField" cols="128" rows="15">
</textarea><br>
</div><br>
The root system in simple basis coordinates follows. <br>


<textarea id="outputField">
</textarea>

<script type="text/javascript">
var CartanSymmetric;
var InvertedCartan;
var theRootSystem;
var theRootSystemLongLength;
var theRootSystemLengths;
var theRootSystemSize;
var theRootSystemHashes;
var theRootSystemHashesSizes;
var HashSize=1000;
var theWeylLetter;
var theWeylDim;
var VectorE1;
var VectorE2;

function generateRootSystemFromWeylLetterAndDim(WeylLetter, WeylDim)
{ if (WeylLetter!="A" && WeylLetter!="B" && WeylLetter!="C" && WeylLetter!="D" && WeylLetter!="E" && WeylLetter!="F" && WeylLetter!="G" )
    return;
  if (WeylDim>9 || WeylDim<1)
    return;
  makeCartanArbitrary(WeylLetter, WeylDim);
  InvertedCartan=invertMatrix(CartanSymmetric);
  VectorE1= new Array(theWeylDim);
  VectorE2= new Array(theWeylDim);
  for (var i=0; i<theWeylDim; i++)
  { VectorE1[i]=(i+1)*(i+1)+1;
    VectorE2[i]=i*3+1;
  }
  AddVectorTimes(VectorE1, VectorE2, -getScalarProduct(VectorE1, VectorE2)/getScalarProduct(VectorE2, VectorE2));
  MultiplyVector(VectorE1, Math.sqrt(1/(getScalarProduct(VectorE1, VectorE1))));
  MultiplyVector(VectorE2, Math.sqrt(1/(getScalarProduct(VectorE2, VectorE2))));
  GenerateRootSystem();
  theRootSystemLengths= new Array(theRootSystem.length);
  theRootSystemLongLength= getScalarProduct(theRootSystem[0], theRootSystem[0]);
  for (var i=0; i<theRootSystemSize; i++)
  { theRootSystemLengths[i]= getScalarProduct(theRootSystem[i], theRootSystem[i]);
    if (theRootSystemLengths[i]>theRootSystemLongLength)
      theRootSystemLongLength=theRootSystemLengths[i];
  }
  ComputeProjections();
}

function ComputeProjections()
{ for (var i=0; i<theWeylDim; i++)
  { Basis[i][0]=GraphicsUnit*getScalarProduct(VectorE1, theRootSystem[i]);
    Basis[i][1]=GraphicsUnit*getScalarProduct(VectorE2, theRootSystem[i]);
  }
}

function MultiplyVector(output, coeff)
{ for (var i=0; i<output.length; i++)
    output[i]*=coeff;
}

function AddVectorTimes(output, inputVector, coeff)
{ for (var i=0; i<output.length; i++)
    output[i]+=inputVector[i]*coeff;
}

function makeCartanArbitrary(WeylLetter, WeylDim)
{ theWeylLetter=WeylLetter;
  theWeylDim= WeylDim;
  if (theWeylLetter=="E")
  { if (theWeylDim<6)
      theWeylDim=6;
    if (theWeylDim>8)
      theWeylDim=8;
  }
  if (theWeylLetter=="G")
    theWeylDim=2;
  if (theWeylLetter=="F")
    theWeylDim=4;
  makeCartanAn(theWeylDim);
  if (theWeylLetter=="B")
  { CartanSymmetric[theWeylDim-1][theWeylDim-1]=1;
  }
  if (theWeylLetter=="C")
  {CartanSymmetric[theWeylDim-1][theWeylDim-1]=4;
   CartanSymmetric[theWeylDim-1][theWeylDim-2]=-2;
   CartanSymmetric[theWeylDim-2][theWeylDim-1]=-2;
  }
  if (theWeylLetter=="F")
  { CartanSymmetric[0][0]=2 ; CartanSymmetric[0][1]=-1;
    CartanSymmetric[1][0]=-1; CartanSymmetric[1][1]=2 ; CartanSymmetric[1][2]=-2;
    CartanSymmetric[2][1]=-2; CartanSymmetric[2][2]=4 ; CartanSymmetric[2][3]=-2;
    CartanSymmetric[3][2]=-2; CartanSymmetric[3][3]=4 ;
  }
  if (theWeylLetter=="D")
  { CartanSymmetric[theWeylDim-2][theWeylDim-1]=0;
    CartanSymmetric[theWeylDim-1][theWeylDim-2]=0;
    CartanSymmetric[theWeylDim-3][theWeylDim-1]=-1;
    CartanSymmetric[theWeylDim-1][theWeylDim-3]=-1;
  }
  if (theWeylLetter=="E")
  { CartanSymmetric[0][1]=0; CartanSymmetric[1][0]=0;
    CartanSymmetric[1][2]=0; CartanSymmetric[2][1]=0;
    CartanSymmetric[0][2]=-1; CartanSymmetric[2][0]=-1;
    CartanSymmetric[1][3]=-1; CartanSymmetric[3][1]=-1;
  }  
  if (theWeylLetter=="G")
  { CartanSymmetric[0][0]=6; CartanSymmetric[0][1]=-3;
    CartanSymmetric[1][0]=-3; CartanSymmetric[1][1]=2;
  }
  document.getElementById("textDim").value=theWeylDim;
  document.getElementById("textType").value=theWeylLetter;  
}

function makeCartanAn(WeylDim)
{ CartanSymmetric= new Array(WeylDim);
  for (var i=0; i<WeylDim; i++)
  { CartanSymmetric[i]= new Array(WeylDim);
    for (var j=0; j<WeylDim; j++)
      CartanSymmetric[i][j]=0;
    CartanSymmetric[i][i]=2;
    if (i<WeylDim-1)
      CartanSymmetric[i][i+1]=-1;
    if (i>0)
      CartanSymmetric[i][i-1]=-1;
  }
}

function ClearRootSystem()
{ theRootSystemHashes= new Array(HashSize);
  theRootSystemHashesSizes= new Array(HashSize);
  theRootSystem= new Object(Array(HashSize));
  for (var i=0; i<HashSize; i++)
  { theRootSystemHashesSizes[i]=0;
    theRootSystemHashes[i]= new Array();
  }
  theRootSystemSize=0;
}

function HashFunctionRoot(theRoot, theWeylDim)
{ var result=0;
  for (var i=0; i<theWeylDim; i++)
    result+=(i+6)*(6+1)*theRoot[i];
  result= result % HashSize;
  if (result<0)
    result+=HashSize;
  return result;
}

function getRootIndex(theRoot, theWeylDim)
{ var theHash = HashFunctionRoot(theRoot, theWeylDim);
  var hashArraySize=theRootSystemHashesSizes[theHash];
  for (var i=0; i<hashArraySize; i++)
  { theIndex=theRootSystemHashes[theHash][i];
    if (AreEqualRoots(theRootSystem[theIndex], theRoot, theWeylDim))
      return theIndex;
  }
  return -1;
}

function AreEqualRoots(root1, root2, theDim)
{ for (var i=0; i<theDim; i++)
    if (root1[i]!=root2[i])
      return false;
  return true;
}

function addToRootSystemNoRepetition(theRoot)
{ var theIndex=getRootIndex(theRoot, theWeylDim);
  if (theIndex==-1)
  { theRootSystem[theRootSystemSize]=new Array(theWeylDim);
    for (var i=0; i<theWeylDim; i++)
      theRootSystem[theRootSystemSize][i]=theRoot[i];
    var theHashIndex=HashFunctionRoot(theRoot, theWeylDim);
    var theHashSize=theRootSystemHashesSizes[theHashIndex];
    theRootSystemHashes[theHashIndex][theHashSize]=theRootSystemSize;
    theRootSystemHashesSizes[theHashIndex]++;
    theRootSystemSize++;
  }
  return false;
}

function getScalarProduct(root1, root2)
{ var result=0; 
  for (var i=0; i<theWeylDim; i++)
    for (var j=0; j<theWeylDim; j++)
      result+= root1[i]*root2[j]*CartanSymmetric[i][j];
  
  return result;
}

function ActOnARootGenIndex(theIndex, input, output)
{ for (i=0; i<theWeylDim; i++)
    output[i]= input[i];
  theScalarProduct=getScalarProduct(theRootSystem[theIndex], input);
  output[theIndex]-= theScalarProduct*2/getScalarProduct(theRootSystem[theIndex],theRootSystem[theIndex]);
  return output;
}

function GenerateRootSystem()
{ var theOutputRoot= new Object(Array(theWeylDim));
  ClearRootSystem();
  for (var j=0; j<theWeylDim; j++)
  { for (var i=0; i<theWeylDim; i++)
      theOutputRoot[i]=0;
    theOutputRoot[j]=1;
    addToRootSystemNoRepetition(theOutputRoot);
  }
  for (var l=0; l<theRootSystemSize; l++)
  { for (var j=0; j<theWeylDim; j++)
    { theOutputRoot=ActOnARootGenIndex(j, theRootSystem[l], theOutputRoot);
      addToRootSystemNoRepetition(theOutputRoot);
    }
  }
  WriteRootSystem();
  drawOnCanvasMain();
}

function WriteRootSystem()
{ var output = document.getElementById("outputField");
  output.value="";
  output.rows=theRootSystemSize;
  var tempS;
  for (var i=0; i<theRootSystemSize; i++)
  { tempS="(";
    for (var j=0; j<theWeylDim; j++)
    { tempS=tempS+theRootSystem[i][j];
      if (j!=theWeylDim-1)
        tempS=tempS+",";
    }
    tempS=tempS+")";
    output.value+=tempS;
    if (i!=theRootSystemSize-1)
      output.value+="\n";
  }  
}
</script>

<script type="text/javascript">
var NumElements=0;
var node;
var surface;
var MaxNumCoords=8;
var Basis= new Array(MaxNumCoords);
var Xshift=200;
var Yshift=200;
var selectedBasisIndex=-1;//-2 = center of coord system is selected
var GraphicsUnit=80;
var clickTolerance=5;
var RootsArray;
var ZeroRoot;
var ButtonIsDown=false;
var DebugString;
var canvasMain=document.getElementById("idCanvasMain");
for (tempCounter=0; tempCounter<MaxNumCoords; tempCounter++)
  Basis[tempCounter]= new Array(2);
tempCounter=0;
Basis[tempCounter][0]=0.3;  Basis[tempCounter][1]=0; tempCounter++; 
Basis[tempCounter][0]=0.4;  Basis[tempCounter][1]=-0.1; tempCounter++; 
Basis[tempCounter][0]=0.4;  Basis[tempCounter][1]=0.1; tempCounter++; 
Basis[tempCounter][0]=-0.8; Basis[tempCounter][1]=1.4; tempCounter++; 
Basis[tempCounter][0]=1.6;  Basis[tempCounter][1]=0.9; tempCounter++; 
Basis[tempCounter][0]=1.6;  Basis[tempCounter][1]=0.8; tempCounter++; 
Basis[tempCounter][0]=1.5;  Basis[tempCounter][1]=0.8; tempCounter++; 
Basis[tempCounter][0]=1.4;  Basis[tempCounter][1]=0.8; tempCounter++; 
for (tempCounter=0; tempCounter<MaxNumCoords; tempCounter++)
{ Basis[tempCounter][0]*= GraphicsUnit;
  Basis[tempCounter][1]*= GraphicsUnit;
} 

function ptsWithinClickTolerance(x1, y1, x2, y2)
{ if (x1-x2>clickTolerance || x2-x1>clickTolerance || y1-y2>clickTolerance || y2-y1>clickTolerance )
    return false;
  return true;
}

function clickCanvasMain(cx,cy)
{ var divPosX=0;
  var divPosY=0;
  var thePointer= canvasMain;
  while(thePointer)
  { divPosX += thePointer.offsetLeft;
    divPosY += thePointer.offsetTop;
    thePointer = thePointer.offsetParent;
  }
  var posx=(cx-divPosX+document.body.scrollLeft-Xshift);
  var posy=-(cy-divPosY+document.body.scrollTop-Yshift);
  selectedBasisIndex=-1;
  if (ptsWithinClickTolerance(posx,posy,0,0))
    selectedBasisIndex=-2;
  for (i=0;i<MaxNumCoords;i++)
  { if (ptsWithinClickTolerance(posx, posy, Basis[i][0], Basis[i][1]))
      selectedBasisIndex=i;
  }
}

function RotateOutOfPlane(input, orthoBasis1, orthoBasis2, oldTanSquared, newTanSquared)
{ var projection= dojo.clone(orthoBasis1);
  var vComponent= dojo.clone(input);
  var scal1= getScalarProduct(orthoBasis1, input);
  var scal2= getScalarProduct(orthoBasis2, input);
  MultiplyVector(projection, scal1);
  AddVectorTimes(projection, orthoBasis2, scal2);
  AddVectorTimes(vComponent, projection, -1);
  DebugString+="\ngetScalarProd="+getScalarProduct(projection, vComponent);
  var oldAngle=Math.atan(Math.sqrt(oldTanSquared));
  var newAngle=Math.atan(Math.sqrt(newTanSquared));
  if (isNaN(oldAngle) || isNaN(newAngle))
    return input;
  var angleChange=-oldAngle+newAngle;  
  projection=dojo.clone(orthoBasis1);
  MultiplyVector(projection,              Math.cos(angleChange)*scal1-Math.sin(angleChange)*scal2);
  AddVectorTimes(projection, orthoBasis2, Math.sin(angleChange)*scal1+Math.sin(angleChange)*scal2);
  var result= vComponent;
  AddVectorTimes(result, projection, 1);  
  return result;
}

function ScaleToUnitLength(vector)
{ MultiplyVector(vector, 1/Math.sqrt(getScalarProduct(vector,vector)));
}

function RootToString(theRoot)
{  var output="(";
  for (var i=0; i<theWeylDim; i++)
  { output=output+ theRoot[i].toFixed(2);
    if (i!=theWeylDim-1)
     output+=",";
  }
  output+=")";
  return output;
}

function getQuadrantFromXandY(theX, theY)
{ if (theX>0 && theY>=0)
    return 1;
  if (theX<=0 && theY>0)
    return 2;
  if (theX<0 && theY<=0)
    return 3;
  return 4;
}

function getAngleFromXandY(x, y, neighborX, neighborY)
{ var result;
  if (x!=0)
   result= Math.atan(y/x);
  else 
    if (y>0)
      result= Math.PI/2;
    else
      result= -Math.PI/2;
  return result;     
}

function changeBasis(selectedIndex, newX, newY)
{ if (newX==0 && newY==0)
    return;
  DebugString="";
  var selectedRoot=theRootSystem[selectedIndex];
  var selectedRootLength=getScalarProduct(selectedRoot,selectedRoot);  
  var oldX=Basis[selectedIndex][0]/GraphicsUnit;
  var oldY=Basis[selectedIndex][1]/GraphicsUnit; 
  newX/=GraphicsUnit;
  newY/=GraphicsUnit;
  var oldAngle= getAngleFromXandY(oldX, oldY, newX, newY);
  var newAngle= getAngleFromXandY(newX, newY, oldX, oldY);    
  var AngleChange= -newAngle+oldAngle;
  var epsilon=0.000015;
  while (AngleChange>=Math.PI/2+epsilon)
  { AngleChange-=Math.PI;}
  while (AngleChange<=-Math.PI/2-epsilon)
  { AngleChange+=Math.PI;}
  DebugString+="\nold angle:"+ oldAngle.toFixed(2);
  DebugString+="\nnew angle: "+newAngle.toFixed(2);
  var NewVectorE1=dojo.clone(VectorE1);
  var NewVectorE2= dojo.clone(VectorE2);
  MultiplyVector(NewVectorE1, Math.cos(AngleChange));
  AddVectorTimes(NewVectorE1, VectorE2, Math.sin(AngleChange));
  MultiplyVector(NewVectorE2, Math.cos(AngleChange));
  AddVectorTimes(NewVectorE2, VectorE1, -Math.sin(AngleChange));
  VectorE1=NewVectorE1;
  VectorE2=NewVectorE2;
  var RootTimesE1=getScalarProduct(selectedRoot, VectorE1);
  var RootTimesE2=getScalarProduct(selectedRoot, VectorE2);
  var vOrthogonal=dojo.clone(selectedRoot);
  var vProjection=dojo.clone(VectorE1); 
  MultiplyVector(vProjection, RootTimesE1);
  AddVectorTimes(vProjection, VectorE2, RootTimesE2);
  AddVectorTimes(vOrthogonal, vProjection, -1);
  var oldRatioProjectionOverHeightSquared = (oldX*oldX+oldY*oldY)/ (selectedRootLength-oldX*oldX-oldY*oldY);
  var newRatioProjectionOverHeightSquared = (newX*newX+newY*newY)/ (selectedRootLength-newX*newX-newY*newY);
  DebugString+="\noldRatio: "+oldRatioProjectionOverHeightSquared;
  DebugString+="\nnewRatio: "+newRatioProjectionOverHeightSquared;
  if (getScalarProduct(vOrthogonal, vOrthogonal)>epsilon || getScalarProduct(vOrthogonal, vOrthogonal)<-epsilon)
  { ScaleToUnitLength(vProjection);
    ScaleToUnitLength(vOrthogonal);
    DebugString+="\nscaled vOrthogonal="+RootToString(vOrthogonal)+"->"+getScalarProduct(vOrthogonal,vOrthogonal);
    DebugString+="\nscaled vProjection="+RootToString(vProjection)+"->"+getScalarProduct(vProjection,vProjection); 
    DebugString+="\ntheScalarProd: "+getScalarProduct(vOrthogonal, vProjection);  
    VectorE1=RotateOutOfPlane(VectorE1, vProjection, vOrthogonal, oldRatioProjectionOverHeightSquared, newRatioProjectionOverHeightSquared);
    VectorE2=RotateOutOfPlane(VectorE2, vProjection, vOrthogonal, oldRatioProjectionOverHeightSquared, newRatioProjectionOverHeightSquared);
  }
  AddVectorTimes(VectorE2, VectorE1, -getScalarProduct(VectorE1, VectorE1)*getScalarProduct(VectorE1, VectorE2));
  ScaleToUnitLength(VectorE1);
  ScaleToUnitLength(VectorE2);
  
  DebugString+="\ne1="+RootToString(VectorE1);
  DebugString+="\ne2="+RootToString(VectorE2);
  DebugString+="\ne1*e2="+getScalarProduct(VectorE1, VectorE2);  
  ComputeProjections();
}

function fixE1AndE2andComputeProjections()
{ var tempE1= new Array(theWeylDim);
  var tempE2= new Array(theWeylDim);
  for (var i=0; i<theWeylDim; i++)
  { tempE1[i]=Basis[i][0];
    tempE2[i]=Basis[i][1];
  }
  VectorE1=matrixActOnRow(InvertedCartan, tempE1);
  VectorE2=matrixActOnRow(InvertedCartan, tempE2);
  var tempLength1=getScalarProduct(VectorE1, VectorE1);
  var tempLength2=getScalarProduct(VectorE2, VectorE2);
  
}

function matrixActOnRow(theMatrix, theRow)
{ var output=new Array(theRow.length);
  for (var i=0; i<theMatrix.length; i++)
  { output[i]=0;
    for (var j=0; j<theMatrix.length; j++)
      output[i]+=theMatrix[j][i]*theRow[j];
  }
  return output;
}

function swapTwoRows(theMatrix, index1, index2)
{ var temp;
  for (var i=0; i<theMatrix.length; i++)
  { temp=theMatrix[index1][i];
    theMatrix[index1][i]=theMatrix[index2][i];
    theMatrix[index2][i]=temp;
  }
}

function addToRowRowTimesCoeff(theMatrix, indexModified, indexOther, coeff)
{ for (var i=0; i<theMatrix.length; i++)
    theMatrix[indexModified][i]+=coeff*theMatrix[indexOther][i];
}

function multiplyRowBy(theMatrix, rowIndex, coeff)
{ for (var i=0; i<theMatrix.length; i++)
    theMatrix[rowIndex][i]*=coeff;
}

function findPivot(theMatrix, columnIndex, minPossibleAnswer)
{ for (var i=minPossibleAnswer; i<theMatrix.length; i++)
    if (theMatrix[i][columnIndex]!=0)
      return i;
  return -1;
}

function getIdentityMatrix(dimension)
{ var answer= new Array(dimension);
  for (var i=0; i<dimension; i++)
  { answer[i]= new Array(dimension);
    for (var j=0; j<dimension; j++)
      if (i==j)
        answer[i][j]=1;
      else
        answer[i][j]=0;
  }
  return answer;
}

function invertMatrix(theInputMatrix)
{ var theMatrix= dojo.clone(theInputMatrix);
  var theDim=theMatrix.length;
  var answer= getIdentityMatrix(theDim);
  for (var i=0; i<theDim; i++)
  { var thePivotIndex=findPivot(theMatrix, i, i);
    if (thePivotIndex==-1)
      return;
    swapTwoRows(answer, thePivotIndex, i);
    swapTwoRows(theMatrix, thePivotIndex, i);
    multiplyRowBy(answer, i, 1/theMatrix[i][i]);    
    multiplyRowBy(theMatrix, i, 1/theMatrix[i][i]);
    for (var j=0; j<theDim; j++)
      if (i!=j)
      { addToRowRowTimesCoeff(answer, j, i, -theMatrix[j][i]);
        addToRowRowTimesCoeff(theMatrix, j, i, -theMatrix[j][i]);
      }
  }
  return answer;
}

function solveTwoByTwoSystem(a11, a12, a21, a22, coeff1, coeff2)
{ var answer= new Array(2);
  var theDeterminant=a11*a22-a21*a12;
  answer[0]=(coeff1*a22-coeff2*a12)/theDeterminant;
  answer[1]=(a11*coeff2-a21*coeff1)/theDeterminant;
  return answer;
} 


 
function mouseHandleWheel(theEvent)
{ theEvent = theEvent ? theEvent : window.event;
  theEvent.preventDefault(); 
  theEvent.stopPropagation();
  theWheelDelta = theEvent.detail ? theEvent.detail * -1 : theEvent.wheelDelta / 40;
  //alert("mousewheel detected! delta: "+theWheelDelta);
  GraphicsUnit+=theWheelDelta;
  ComputeProjections();
  drawOnCanvasMain();
}

function mouseMoveRedraw(cx, cy)
{ if (selectedBasisIndex!=-1)
  { var divPosX=0;
    var divPosY=0;
    var thePointer= canvasMain;
    while(thePointer)
    { divPosX += thePointer.offsetLeft;
      divPosY += thePointer.offsetTop;
      thePointer = thePointer.offsetParent;
    }
    var posx=(cx-divPosX+document.body.scrollLeft-Xshift);
    var posy=-(cy-divPosY+document.body.scrollTop-Yshift);
    if (selectedBasisIndex==-2)
    { Xshift=(cx-divPosX+document.body.scrollLeft);
      Yshift=(cy-divPosY+document.body.scrollTop);
    }
		else
    {	//posx=50; posy=50;
      changeBasis(selectedBasisIndex, posx, posy);
    }
    drawOnCanvasMain();
  }
}

function getCoord(thePoint, Coord)
{ var result=Number(0);
  for (var counterI=0; counterI<theWeylDim; counterI++)
    result= result+ thePoint[counterI]*Basis[counterI][Coord];
  result=Math.floor(result);
  return result;
}

function drawLineBetweenZeroAndRoot(theRoot)
{ xCoord1=getCoord(ZeroRoot,0)+Xshift;
  yCoord1=-getCoord(ZeroRoot,1)+Yshift;
  xCoord2=getCoord(theRoot,0)+Xshift;
  yCoord2=-getCoord(theRoot,1)+Yshift;
  var theColor;
  if (getScalarProduct(theRoot, theRoot)==theRootSystemLongLength)
    theColor ="blue";
  else
    theColor ="#C0C0FF"; 
  surface.createLine({ x1 : xCoord1, y1 : yCoord1, x2 : xCoord2, y2 : yCoord2 }).setStroke({color : theColor});
}

function drawCircleAtRoot(theRoot)
{ xCoord1=getCoord(theRoot,0)+Xshift;
  yCoord1=-getCoord(theRoot,1)+Yshift;
  surface.createEllipse({ cx : xCoord1, cy : yCoord1, rx : 2, ry : 2 }).setStroke({color : "red"});
}

function drawTextAtRoot(theRoot, theText)
{ xCoord1=getCoord(theRoot,0)+Xshift;
  yCoord1=-getCoord(theRoot,1)+Yshift;
  var tempText=surface.createText({x: xCoord1, y: yCoord1, text: theText});
  tempText.setFont({family : "Arial", size : "9pt"});
  tempText.setStroke("black");
}

function drawOnCanvasMain()
{//	alert("paint");
  surface.clear();
  ZeroRoot= new Array(theWeylDim);
  var tempRoot=new Array(theWeylDim);
  surface.createLine({ x1 : Xshift, y1 : Yshift, x2 : Xshift, y2 : Yshift-GraphicsUnit }).setStroke({color : "#EFEFEF"});
  surface.createLine({ x1 : Xshift, y1 : Yshift, x2 : Xshift+GraphicsUnit, y2 : Yshift }).setStroke({color : "#EFEFEF"});
  for (var i=0; i<theWeylDim; i++)
  { ZeroRoot[i]=0;
    tempRoot[i]=0;
  }
  for (var i=0; i<theWeylDim; i++)
  { tempRoot[i]=1;
    drawCircleAtRoot(tempRoot);
    drawTextAtRoot(tempRoot, i+1);
    tempRoot[i]=0;
  }
  for (var CounterK=0; CounterK<theRootSystemSize; CounterK++)
    drawLineBetweenZeroAndRoot(theRootSystem[CounterK]);  
  var debugLog = document.getElementById("debugField");
  debugLog.value=DebugString;
}

function initDojo()
{ node = dojo.byId("idCanvasMain");
  surface = dojox.gfx.createSurface(node, 400, 400);
  initRecompute();
}

function initRecompute()
{ var tempWeylLetter=document.getElementById("textType").value;
  var tempWeylDim=document.getElementById("textDim").value;
  tempWeylDim=Number(tempWeylDim);
  tempWeylLetter=tempWeylLetter.toUpperCase();
  generateRootSystemFromWeylLetterAndDim(tempWeylLetter, tempWeylDim); 
  drawOnCanvasMain();
}
dojo.require("dojox.gfx");
dojo.addOnLoad(initDojo);
</script>
<!>
</body>
</html>

